# TasQ Flow 統合要件仕様書

## 1. システム概要

TasQ Flowは、チームと個人のタスク管理を効率化する高機能ガントチャートベースの業務支援Webアプリケーションです。

### 1.1 主要な特徴
- ガントチャート形式でのタスク可視化
- リアルタイム同期による複数人での同時編集
- 階層的なプロジェクト・タスク管理
- 高度な検索・フィルタリング機能
- プライバシー設定による柔軟な情報管理

## 2. 技術仕様

### 2.1 技術スタック
- **フロントエンド**: React 18 + TypeScript
- **UIライブラリ**: Material-UI v5
- **状態管理**: Zustand
- **ビルドツール**: Vite
- **日付処理**: date-fns

### 2.2 パフォーマンス最適化
- **仮想化スクロール**: 20年分のカレンダー表示（2020-2040）に対応
- **可視範囲のみレンダリング**: スクロール位置に応じて必要な要素のみ描画
- **バッファリング**: 前後30日分のバッファで滑らかなスクロール体験

## 3. UI/UX設計

### 3.1 レイアウト構成
```
┌─────────────────────────────────────────────────────────┐
│                    ヘッダー（検索バー）                      │
├──────────────┬──────────────────────────────┬──────────┤
│              │     ガントチャート表示エリア      │ タスク詳細 │
│   プロジェクト  │  ┌──────────────────────┐    │          │
│   タスク一覧   │  │  カレンダー（タイムスケール） │    │（オプション）│
│   （ネスト表示） │  ├──────────────────────┤    │          │
│              │  │      タスクバー表示        │    │          │
│              │  └──────────────────────┘    │          │
└──────────────┴──────────────────────────────┴──────────┘
```

### 3.2 三層サイドバーシステム
1. **チーム層**: プロジェクトチームの一覧
2. **プロジェクト層**: 選択されたチームのプロジェクト一覧
3. **タスク層**: プロジェクト内のタスクをネスト表示

### 3.3 カラー管理
- チーム・プロジェクト・タスクごとに個別カラー設定
- 明度・コントラストの自動補正
- アクセシビリティを考慮した色調整

## 4. 主要機能

### 4.1 ガントチャート機能
- **表示期間**: 2020年〜2040年（仮想化により拡張可能）
- **ズーム機能**: 0.25倍〜4倍のスケール調整
- **スクロール同期**: サイドバーとチャートエリアの縦スクロール同期
- **ドラッグ&ドロップ**: タスクの移動・リサイズ
- **今日ライン**: 現在日の視覚的表示

### 4.2 タスク管理
- **階層構造**: 1階層の親子関係（タスクグループとタスク）
- **タスクフォグ**: 個人スケジュールブロック（1人1つ、重複なし）
- **進捗管理**: パーセンテージ表示とビジュアルフィードバック
- **優先度設定**: 高・中・低の3段階
- **ステータス管理**: 未着手・進行中・完了・保留

### 4.3 検索・フィルタリング
- **複合条件検索**: 
  - `@メンバー名`: メンバーで絞り込み
  - `#タグ`: タグで絞り込み
  - `%進捗率`: 進捗率で絞り込み
  - `^稼働率`: 稼働率で絞り込み
- **検索履歴**: 最近の検索条件を保存
- **ハイライト表示**: 検索結果の視覚的強調

### 4.4 表示タブ
1. **ガントチャートタブ**: メイン表示
2. **メンバータブ**: チームメンバーとヒートマップ
3. **付箋タブ**: アクリル風UIの付箋機能
4. **ToDoタブ**: チェックリスト統合
5. **変更履歴タブ**: 権限者のみアクセス可能
6. **設定タブ**: ユーザー設定と管理者機能

### 4.5 プライバシー設定
- **完全公開**: すべての情報を公開
- **期間のみ公開**: タスクの期間のみ表示
- **完全非公開**: ヒートマップにのみ反映

### 4.6 リアルタイム同期
- WebSocketによる即時同期
- 競合検出と自動解決
- オフライン対応とデータ復旧

## 5. データ構造

### 5.1 主要エンティティ

#### ProjectTeam（プロジェクトチーム）
```typescript
interface ProjectTeam {
  id: string;
  name: string;
  description: string;
  color: string;
  members: Member[];
  createdAt: Date;
  updatedAt: Date;
}
```

#### Project（プロジェクト）
```typescript
interface Project {
  id: string;
  teamId: string;
  name: string;
  description: string;
  color: string;
  status: 'planning' | 'active' | 'completed' | 'onHold';
  progress: number;
  tasks: Task[];
  members: Member[];
  createdAt: Date;
  updatedAt: Date;
}
```

#### Task（タスク）
```typescript
interface Task {
  id: string;
  projectId: string;
  title: string;
  description?: string;
  startDate: Date;
  endDate: Date;
  assignees: string[];
  progress: number;
  priority: number; // 0-100
  status: 'notStarted' | 'inProgress' | 'completed' | 'onHold';
  tags: string[];
  color?: string;
  isGroup: boolean;
  parentId?: string;
  children?: string[];
  checklist?: ChecklistItem[];
  privacyLevel: 'public' | 'dateOnly' | 'private';
}
```

## 6. 実装済み機能

### 6.1 コア機能
- ✅ ガントチャート表示（仮想化対応）
- ✅ プロジェクト・タスクのネスト表示
- ✅ タスクのドラッグ&ドロップ
- ✅ リアルタイム同期基盤
- ✅ 検索・フィルタリング
- ✅ タブ切り替えUI

### 6.2 拡張機能
- ✅ メンバーヒートマップ
- ✅ 付箋機能（アクリル風UI）
- ✅ ToDoチェックリスト統合
- ✅ 変更履歴表示
- ✅ ユーザー設定・管理者機能
- ✅ エクスポート機能（PDF/画像）

### 6.3 パフォーマンス最適化
- ✅ カレンダー仮想化（20年分対応）
- ✅ スクロール同期
- ✅ 可視範囲のみレンダリング

## 7. 今後の実装予定

### 7.1 バックエンド統合
- WebSocket サーバー実装
- データベース設計・実装
- 認証・認可システム
- APIエンドポイント設計

### 7.2 追加機能
- 通知システム
- ファイル添付機能
- コメント機能
- アクティビティログ
- レポート生成

### 7.3 モバイル対応
- レスポンシブデザイン
- タッチ操作最適化
- 軽量モード自動切替

## 8. 運用要件

### 8.1 推奨環境
- **ブラウザ**: Chrome/Edge/Firefox/Safari 最新版
- **画面解像度**: 1920×1080以上推奨
- **メモリ**: 4GB以上推奨

### 8.2 パフォーマンス目標
- 初期読み込み: 3秒以内
- タスク操作レスポンス: 100ms以内
- 同時接続ユーザー: 100人以上

## 9. セキュリティ要件

### 9.1 データ保護
- HTTPS通信の強制
- データの暗号化
- XSS/CSRF対策

### 9.2 アクセス制御
- ロールベースアクセス制御（RBAC）
- プロジェクト単位の権限管理
- 監査ログの記録

## 10. 開発ガイドライン

### 10.1 コーディング規約
- TypeScript strict mode 使用
- ESLint/Prettier による自動フォーマット
- 日本語コメント・ドキュメント推奨

### 10.2 テスト方針
- 単体テスト: Jest + React Testing Library
- 統合テスト: Cypress
- パフォーマンステスト: Lighthouse

### 10.3 デプロイメント
- CI/CD パイプライン構築
- ステージング環境での検証
- ブルーグリーンデプロイメント

---

**最終更新日**: 2024年6月25日
**バージョン**: 1.0.0